<div class="user-table">
    <div class="container-fluid">
        <div class="card shadow mb-4">
            <div class="card-header py-3">
                <h6 class="m-0 font-weight-bold text-primary d-lg-inline">All Users</h6>
                <button type="button" class="btn btn-primary float-right" (click)="openModal(template,null)" *ngIf="addPermission">Add
                    User</button>
                <!-- Add User Model -->
                <ng-template #template>
                    <div class="modal-header">
                        <h4 class="modal-title pull-left text-primary">Add Users</h4>
                        <button type="button" class="btn-close" aria-label="Close" (click)="modalRef?.hide()">
                            <span aria-hidden="true" class="visually-hidden">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="py-2">
                            <form [formGroup]="userFrom" (ngSubmit)="addUsers()" autocomplete="off">
                                <div class="container">
                                    <div class="row">
                                        <div class="col-6">
                                            <div class="form-group">
                                                <label>First Name</label>
                                                <input type="text" class="form-control" formControlName="FirstName"
                                                    [ngClass]="
                                                (userFrom.get('FirstName')?.touched || 
                                                userFrom.get('FirstName')?.dirty) && 
                                                userFrom.get('FirstName')?.errors
                                                ? 'is-invalid' 
                                                : ''||  (userFrom.get('FirstName')?.touched || 
                                                userFrom.get('FirstName')?.dirty) && 
                                                !userFrom.get('FirstName')?.invalid
                                                ? 'is-valid' 
                                                : '' " required>
                                            </div>
                                        </div>

                                        <div class="col-6">
                                            <div class="form-group">
                                                <label>Last Name</label>
                                                <input type="test" class="form-control" formControlName="LastName"
                                                    [ngClass]="
                                                (userFrom.get('LastName')?.touched || 
                                                userFrom.get('LastName')?.dirty) && 
                                                userFrom.get('LastName')?.errors
                                                ? 'is-invalid' 
                                                : ''||  (userFrom.get('LastName')?.touched || 
                                                userFrom.get('LastName')?.dirty) && 
                                                !userFrom.get('LastName')?.invalid
                                                ? 'is-valid' 
                                                : '' " required>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="container">
                                    <div class="row">
                                        <div class="col-6">
                                            <div class="form-group">
                                                <label>Contact Number</label>
                                                <input type="text" class="form-control" formControlName="Contact"
                                                    pattern="^((\\+91-?)|0)?[0-9]{10}$" [ngClass]="
                                                (userFrom.get('Contact')?.touched || 
                                                userFrom.get('Contact')?.dirty) && 
                                                userFrom.get('Contact')?.hasError('required')
                                                ? 'is-invalid' 
                                                : ''||  
                                                userFrom.get('Contact')?.getError('pattern') 
                                                ? 'is-invalid' 
                                                : '' ||  
                                                (userFrom.get('Contact')?.touched || 
                                                userFrom.get('Contact')?.dirty) && 
                                                !userFrom.get('Contact')?.invalid
                                                ? 'is-valid' 
                                                : '' " required>
                                            </div>
                                        </div>

                                        <div class="col-6">
                                            <div class="form-group">
                                                <label for="exampleInputEmail1">Email address</label>
                                                <input type="email" class="form-control" formControlName="Email"
                                                    pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$" [ngClass]="
                                                (userFrom.get('Email')?.touched || 
                                                userFrom.get('Email')?.dirty) && 
                                                userFrom.get('Email')?.hasError('required')
                                                ? 'is-invalid' 
                                                : '' || 
                                                userFrom.get('Email')?.getError('pattern') 
                                                ? 'is-invalid' 
                                                : '' ||  
                                                (userFrom.get('Email')?.touched || 
                                                userFrom.get('Email')?.dirty) && 
                                                !userFrom.get('Email')?.invalid
                                                ? 'is-valid' 
                                                : '' " required>

                                                <small class="form-text text-muted">We will never share your email with
                                                    anyone else.</small>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="container">
                                    <div class="row">
                                        <div class="col-6">
                                            <div class="form-group" *ngIf="showPassword">
                                                <label>Password</label>
                                                <input type="password" class="form-control" formControlName="Password"
                                                    pattern="^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$"
                                                    [ngClass]="
                                                (userFrom.get('Password')?.touched || 
                                                userFrom.get('Password')?.dirty) && 
                                                userFrom.get('Password')?.hasError('required')
                                                ? 'is-invalid' 
                                                : '' || 
                                                userFrom.get('Password')?.getError('pattern') 
                                                ? 'is-invalid' 
                                                : '' ||  
                                                userFrom.get('Password')?.getError('minlength') 
                                                ? 'is-invalid' 
                                                : '' ||  
                                                (userFrom.get('Password')?.touched || 
                                                userFrom.get('Password')?.dirty) && 
                                                !userFrom.get('Password')?.invalid
                                                ? 'is-valid' 
                                                : '' " required>
                                                <small class="form-text text-muted">password must be of 8 characters.
                                                    one
                                                    uppercase one lowercase one number & one special character</small>
                                            </div>
                                        </div>

                                        <div class="col-6">
                                            <div class="form-group" *ngIf="showPassword">
                                                <label>Confirm Password</label>
                                                <input type="password" class="form-control"
                                                    formControlName="ConfirmPassword" [ngClass]="
                                                (userFrom.get('ConfirmPassword')?.touched || 
                                                userFrom.get('ConfirmPassword')?.dirty) && 
                                                userFrom.get('ConfirmPassword')?.hasError('required')
                                                ? 'is-invalid' : '' || 
                                                userFrom.get('ConfirmPassword')?.getError('MustMatch') 
                                                ? 'is-invalid' 
                                                : ''||
                                                (userFrom.get('ConfirmPassword')?.touched || 
                                                userFrom.get('ConfirmPassword')?.dirty) && 
                                                !userFrom.get('ConfirmPassword')?.invalid
                                                ? 'is-valid' 
                                                : '' " required>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="container">
                                    <div class="row">
                                        <div class="col-6">
                                            <label>Role*</label>
                                            <select class="form-select" aria-label="Default select example"
                                                formControlName="Role" [ngClass]="
                                                        (userFrom.get('Role')?.touched || 
                                                        userFrom.get('Role')?.dirty) && 
                                                        userFrom.get('Role')?.errors
                                                        ? 'is-invalid' 
                                                        : ''||  (userFrom.get('Role')?.touched || 
                                                        userFrom.get('Role')?.dirty) && 
                                                        !userFrom.get('Role')?.invalid
                                                        ? 'is-valid' 
                                                        : '' " required>
                                                <option *ngFor="let Role of roles" [value]="Role.name">
                                                    {{Role.normalizedName}}</option>
                                            </select>
                                        </div>

                                        <div class="col-6 mt-4">
                                            <div class="form-check">
                                                <input type="checkbox" class="form-check-input"
                                                    formControlName="Remember">
                                                <label class="form-check-label" for="exampleCheck1">Remember Me</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="float-right">
                                    <button type="submit" class="btn btn-primary" [disabled]="!userFrom.valid">Submit</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </ng-template>
            </div>
            <div class="card-body">
                <div class="table-responsive table-wrapper-scroll-y my-custom-scrollbar table-hover">
                    <table class="table table-bordered" id="dataTable" width="100%" cellspacing="0">
                        <thead class="thead-dark">
                            <tr>
                                <th>First Name</th>
                                <th>Last Name</th>
                                <th>Contact</th>
                                <th>Email</th>
                                <th>Role</th>
                                <th class="text-center" style="width: 9%;">Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let item of users;let i = index">
                                <td>{{item.firstName}}</td>
                                <td>{{item.lastName}}</td>
                                <td>{{item.contact}}</td>
                                <td>{{item.email}}</td>
                                <td>{{item.role}}</td>
                                <td class="text-center">
                                    <button class="action-button text-primary action-button" data-toggle="tooltip"
                                        title="Edit" (click)="openModal(template,i)"><i class="fas fa-pen" *ngIf="editPermission"></i></button>
                                    <button class="action-button text-danger action-button" data-toggle="tooltip"
                                        title="Delete" (click)="deleteUserById(i)" *ngIf="deletePermission"><i class="fas fa-trash"></i></button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>